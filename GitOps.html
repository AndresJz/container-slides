<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>

<title>GitOps</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/reveal.css"/>
<link rel="stylesheet" href="themes/theme2020.css" id="theme"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.0.2/styles/isbl-editor-dark.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3.1.0/notyf.min.css" />
<script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/print/pdf.css' : 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>
<script src="https://kit.fontawesome.com/979b781914.js" crossorigin="anonymous"></script>

<style>
    html.dimbg75 .slide-background {
        opacity: 0.75 !important;
    }
    .center-image {
        display: block;
        margin-left: auto !important;
        margin-right: auto !important;
    }
</style>
</head>

<body>
<div class="reveal">
<div class="slides">

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        <!-- .slide: data-background="images/communication-4871245_1920.jpg" class="center" style="text-align: center; background: rgba(0, 0, 0, 0.5);" -->

        # GitOps

        <b>*Nicholas Dille*</b>

        <i class="fab fa-docker" style="width: 1.5em; text-align: center;"></i> <b>Docker Captain</b> &amp; <i class="fab fa-windows" style="width: 1.5em; text-align: center;"></i> <b>Microsoft MVP</b>
    </textarea></section>

    <section data-markdown="000_introduction/02_bio.md" data-separator="^---$" data-separator-vertical="^--$"></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Agenda

        What is GitOps

        How it works

        Noteworthy projects
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        <!-- .slide: class="center" -->

        *GitOps: versioned CI/CD on top of declarative infrastructure. Stop scripting and start shipping.*

        [Kelsey Hightower, Developer Advocate @ Google](https://twitter.com/kelseyhightower/status/953638870888849408)
        <!-- .element: style="text-align: right;" -->
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## What is GitOps

        Continuous Deployment for Cloud Native Applications

        Developer centric experience when operating infrastructure
        
        Version control as single source of truth

        Declarative infrastructure as desired state

        Automation is key

        Ops can learn from devs

        Invented by WeaveWorks in 2017
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## GitOps != DevOps

        ### DevOps is cultural change

        Shared responsibility

        Tools can support but are not essential

        ### GitOps is a methodology

        Technical implementation
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## How to do GitOps?

        Version control

        Declarative infrastructure

        Automation to *make it so*

        Minimize glue code

        You decide
        - Repository layout (monorepo or multirepo)
        - Development mode (trunk-based or gitflow)
        - Stages (one or more)
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## How to do GitOps?
        
        When this becomes religion...

        ### Push deployment

        All-knowing CI/CD pipeline

        Extensive permissions required

        WeaveWorks calls this *CIOps*

        ### Pull deployment
        
        Preached by WeaveWorks

        Smaller attack surface due to few permissions
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Do not be religious

        ### Doing CIOps is just fine

        Select well-established CI/CD tool

        Do pipeline-as-code

        Do fully automated deployments

        Redeploy regularly

        Calling it GitOps is also fine ;-)

        ### *Official GitOps* may be an evolutionary step
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Noteworthy projects

        Most certainly not exhaustive ;-)

        ### [flux](https://fluxcd.io/)

        The GitOps reference project
        
        Created by [WeaveWorks](https://www.weave.works/), CNCF [sandbox project](https://www.cncf.io/sandbox-projects/)

        ### [tekton](https://tekton.dev/)

        Kubernetes native CI/CD
        
        Part of the [cd.foundation](https://cd.foundation/)

        Jenkins X builds on top

        --

        ## Demo: flux

        GitOps for Kubernetes

        Cluster state is stored in git repository

        Changes are deployed automatically every 5m

        Automated image updates

        CLI `fluxctl`
        
        --

        ## Demo: tekton

        Pipelines executed natively inside Kubernetes

        Pipelines are expressed as YAML documents

        Example `Task`:

        ```yaml
        apiVersion: tekton.dev/v1beta1
        kind: Task
        metadata:
          name: echo-hello-world
        spec:
          steps:
          - name: echo
            image: ubuntu
            command:
            - echo
            args:
            - "Hello World"
        ```

        --

        ## Demo: tekton

        Example `TaskRun`:

        ```yaml
        apiVersion: tekton.dev/v1beta1
        kind: TaskRun
        metadata:
          name: echo-hello-world-task-run
        spec:
          taskRef:
            name: echo-hello-world
        ```
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Secrets

        ### Push deployment
        
        Permissions in target environment required
        
        Secrets are injected by pipeline

        ### Pull deployment

        Deployments performed from inside the target environment
        
        Secrets using [Sealed Secrets](https://github.com/bitnami-labs/sealed-secrets) or pulled from Vault
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Privileges

        ### Least privileges

        Deny by default and add permissions

        Use deploy keys but harder for auditing

        Do not compromise

        ### Separation of concerns

        Dedicated account per use case

        Evaluate permissions per account
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Security in dev and ops

        Make human interaction more secure

        ### Local development

        Always add `.env` to your `.gitignore`

        Place required environment variables in `.env`

        ### Troubleshooting

        Default to read access to live environment

        Limit interactive access to target system
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## GitOps in DevInfra

        Fully automated using push deployments

        Branch represents one instance or stage of a service

        ### Example 1: Monitoring-as-a-Service (MaaS)
        
        One branch represents one deployment dedicated to a team

        ### Example 2: Kubernetes cluster
        
        Deployed from one repository
        
        One branch represents a cluster
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Summary

        WeaveWorks invented GitOps in 2017

        GitOps is...
        
        ...automated ops

        ...from version control

        ...using declarative infrastructure

        (...using pull deployments)

        WeaveWorks `flux` implements GitOps

        CIOps is also fine ;-)
    </textarea></section>

    <section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
        ## Further reading

        [gitops.tech](https://www.gitops.tech/)

        [Weave Works blog](https://www.weave.works/blog/category/gitops/)

        [Guide to GitOps](https://www.weave.works/technologies/gitops/)

        [CIOps as an anti-pattern](https://www.weave.works/blog/kubernetes-anti-patterns-let-s-do-gitops-not-ciops)

        [Awesome GitOps](https://github.com/weaveworks/awesome-gitops)
    </textarea></section>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/js/reveal.min.js" type="application/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/notyf@3.1.0/notyf.min.js"></script>
<script>
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: false,
        transition: 'convex',
        backgroundTransition: 'fade',

        allottedTime: 45 * 60 * 1000,
        keyboard: {
            // pause/resume time when Enter is pressed
            13: () => {
                ElapsedTimeBar.isPaused ? ElapsedTimeBar.resume() : ElapsedTimeBar.pause();
            },
            // reset timer when 'r' is pressed
            82: () => {
                ElapsedTimeBar.reset();
            }
        },

        dependencies: [
            { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/lib/js/classList.js', condition: function() { return !document.body.classList; } },
            { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/zoom-js/zoom.js', async: true },
            { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/notes/notes.js' },
            { src: 'plugins/elapsed-time-bar-2699fc8/elapsed-time-bar.js'}

        ]
    });

    /*
    var clipboard = new ClipboardJS(".hljs", {
        text: function(trigger) {
            return trigger.innerText;
        }
    });
    clipboard.on("success", function(e) {
        var notyf = new Notyf();
        notyf.success("Copied to clipboard :)");
    });
    clipboard.on("error", function(e) {
        var notyf = new Notyf();
        notyf.error("Can't copy to clipboard :(");
    });
    */
</script>

</body>
</html>
